<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mockito 详解（三）插桩 | 梁飞</title>
  <meta name="author" content="liangfei">
  
  <meta name="description" content="梁飞的个人博客">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Mockito 详解（三）插桩"/>
  <meta property="og:site_name" content="梁飞"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="梁飞" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">梁飞</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archive</a></li>
    
      <li><a href="/about">About</a></li>
    

    
      <li><a href="https://zhuanlan.zhihu.com/youzanmobile" target="_blank">知乎</a></li>
    
      <li><a href="https://github.com/lyndonchin" target="_blank">Github</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-07-07T16:00:00.000Z"><a href="/2017/07/08/mockito-details-3-stubbing/">2017-07-08</a></time>
      
      
  
    <h1 class="title">Mockito 详解（三）插桩</h1>
  

    </header>
    <div class="entry">
      
        <p>每次插桩（Stubbing）都会产生一个 Invocation，本篇从 Invocation 着手，重点分析插桩的原理。</p>
<a id="more"></a>
<p>Invocation 之间的关系如下所示：</p>
<pre><code>+----------+              +----------+
| StubInfo |--stubbedAt--&gt;| Location |
+----------+              +----------+
     /|\
      |
 implements
      |  
      |  
+--------------+                            +---------------------+
| StubInfoImpl |-----has a-----------------&gt;| DescribedInvocation |
+--------------+                            +---------------------+

+---------------------+
| DescribedInvocation |
+---------------------+
     /|\         /|\  \ 
      |           |     \        +------------------+
      |           |       \      | InvocationOnMock | 
      |           |         \    +------------------+
      |           |           \       / 
      |           |           extends
      |        extends           \ /
      |           |        +------------+
 implements       |        | Invocation |
      |           |        +------------+
      |           |                  /|\
      |     +---------------------+   |
      |     | MatchableInvocation |   |
      |     +---------------------+   |
      |             /|\               |
      |              |                |
      |         implements           has
      |              |                |
      |              |                |
   +-------------------+              |
   | InvocationMatcher |--------------+
   +-------------------+
              |
              |                         +-----------------+
              +------ has list of -----&gt;| ArgumentMatcher |
                                        +-----------------+
</code></pre><p><code>MatchableInvocation</code> 与 <code>Invocation</code> 的区别如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">mock.foo();   <span class="comment">// &lt;- invocation</span></div><div class="line">verify(mock).bar();  <span class="comment">// &lt;- matchable invocation</span></div></pre></td></tr></table></figure>
<h2 id="MockHandler"><a href="#MockHandler" class="headerlink" title="MockHandler"></a>MockHandler</h2><p><code>Invocation</code> 通过 <code>MockHandler</code> 进行处理：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MockHandler</span> <span class="keyword">extends</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">    <span class="function">Object <span class="title">handle</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Mockito 提供的的 <code>MockHandler</code> 实现了如下功能：</p>
<ol>
<li>记录 Mock 对象上的方法调用以进行后续验证</li>
<li>当 Mock 对象被插桩之后捕获 stubbing 信息</li>
<li>返回 invocation 的插桩值</li>
</ol>
<hr>
<p>Invocation 表示在 Mock 方法上的一次调用，它包含两部分信息 DescribedInvocation &amp; InvocationOnMock。</p>
<blockquote>
<p>A method call on a mock object. Contains all information and state needed for the Mockito framework to operate.</p>
</blockquote>
<h2 id="DescribedInvocation"><a href="#DescribedInvocation" class="headerlink" title="DescribedInvocation"></a>DescribedInvocation</h2><p><code>DescribedInvocation</code> 只是用于描述 <code>Invocation</code>。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DescribedInvocation</span> </span>&#123;</div><div class="line">    <span class="function">String <span class="title">toString</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">Location <span class="title">getLocation</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中 <code>Location</code> 用于描述 <code>Invocation</code> 的位置：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Location</span> </span>&#123;</div><div class="line">    <span class="function">String <span class="title">toString</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="InvocationOnMock"><a href="#InvocationOnMock" class="headerlink" title="InvocationOnMock"></a>InvocationOnMock</h2><p><code>InvocationOnMock</code> 用于表示 <code>Invocation</code> 和 <code>Mock</code> 之间的数据联系。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InvocationOnMock</span> <span class="keyword">extends</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">    <span class="function">Object <span class="title">getMock</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">Method <span class="title">getMethod</span><span class="params">()</span></span>;</div><div class="line">    Object[] getArguments();</div><div class="line">    &lt;T&gt; <span class="function">T <span class="title">getArgument</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</div><div class="line">    <span class="function">Object <span class="title">callRealMethod</span><span class="params">()</span> <span class="keyword">throws</span> Throwable</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Invocation"><a href="#Invocation" class="headerlink" title="Invocation"></a>Invocation</h2><p><code>Invocation</code> 除此之外，还包含其他功能：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Invocation</span> <span class="keyword">extends</span> <span class="title">InvocationOnMock</span>, <span class="title">DescribedInvocation</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isVerified</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getSequenceNumber</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">Location <span class="title">getLocation</span><span class="params">()</span></span>;</div><div class="line">    Object[] getRawArguments();</div><div class="line">    Class&lt;?&gt; getRawReturnType();</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">markVerified</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">StubInfo <span class="title">stubInfo</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">markStubbed</span><span class="params">(StubInfo stubInfo)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isIgnoredForVerification</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ignoreForVerification</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>StubInfo</code> 用于描述 stubbing：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StubInfo</span> </span>&#123;</div><div class="line">    <span class="function">Location <span class="title">stubbedAt</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="MatchableInvocation"><a href="#MatchableInvocation" class="headerlink" title="MatchableInvocation"></a>MatchableInvocation</h2><p><code>MatchableInvocation</code> 包含 <code>Invocation</code> 实例和 <code>ArgumentMatcher</code> 列表。它用于验证的过程（verification process）。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MatchableInvocation</span> <span class="keyword">extends</span> <span class="title">DescribedInvocation</span> </span>&#123;</div><div class="line">    <span class="function">Invocation <span class="title">getInvocation</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">List&lt;ArgumentMatcher&gt; <span class="title">getMatchers</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(Invocation candidate)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasSimilarMethod</span><span class="params">(Invocation candidate)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasSameMethod</span><span class="params">(Invocation candidate)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">captureArgumentsFrom</span><span class="params">(Invocation invocation)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="InvocationContainer-关系图"><a href="#InvocationContainer-关系图" class="headerlink" title="InvocationContainer 关系图"></a>InvocationContainer 关系图</h2><pre><code>+---------------------+                           +------------+
| InvocationContainer |--- clear / get list of---&gt;| Invocation |
+---------------------+                           +------------+
</code></pre><h2 id="Stubbing-关系图"><a href="#Stubbing-关系图" class="headerlink" title="Stubbing 关系图"></a>Stubbing 关系图</h2><pre><code>   +-----------------+
   | OngoingStubbing |
   +-----------------+
           /|\
            |
        implements
            |
            |
   +-----------------+
   |   BaseStubbing  |&lt;-----------------+
   +-----------------+                  | 
           /|\                          |
            |                           |
         extends                     extends 
            |                           |
            |                           |
+----------------------+    +---------------------+
| ConsecutiveStubbing  |    | OngoingStubbingImpl |
+----------------------+    +---------------------+
</code></pre><h2 id="Stubbing"><a href="#Stubbing" class="headerlink" title="Stubbing"></a>Stubbing</h2><p>Stubbing 表示一次插桩，它的形式是 <code>when(x).then(y)</code>，用于指定 mock 的行为。</p>
<p><em>Stubbing 的示例代码</em><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">when(mock.foo()).thenReturn(<span class="keyword">true</span>);</div></pre></td></tr></table></figure></p>
<p>可以通过如下代码获取 mock 对象的所有 stubbing：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">Mockito.mockingDetails(mock).getStubbings();</div></pre></td></tr></table></figure>
<p>Stubbing 的接口规范如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Stubbing</span> </span>&#123;</div><div class="line">    <span class="function">Invocation <span class="title">getInvocation</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">wasUsed</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><code>getInvocation()</code> 返回被插桩的方法调用，例如，<code>mock.foo()</code> 就是一个 <code>Invocation</code>。</li>
<li><code>wasUsed()</code> 用于表示 stubbing 是否被使用，如果 <code>mock.foo()</code> 没有被调用，那么 <code>wasUsed()</code> 返回 false，说明存在未被使用的 stubbing，为了保持 <code>clarity of tests</code>，最好删除未被使用的 stubbing 代码。</li>
</ul>
<h2 id="Stubber"><a href="#Stubber" class="headerlink" title="Stubber"></a>Stubber</h2><p>Stubber 是一个插装器。</p>
<p>当我们用 <code>doThrow()|doAnswer()|doNothing()|doReturn()</code> 的形式进行插桩时，可以通过 Stubber 来选择 mock 对象的方法：</p>
<p><em>示例一</em><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">doThrow(<span class="keyword">new</span> RuntimeException()).when(mockedList).clear();</div></pre></td></tr></table></figure></p>
<p><em>示例二</em><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">doThrow(<span class="keyword">new</span> RuntimeException(<span class="string">"one"</span>)).doThrow(<span class="keyword">new</span> RuntimeException(<span class="string">"two"</span>)).when(mock).someVoidMethod();</div></pre></td></tr></table></figure></p>
<p>Stubber 接口定义如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Stubber</span> </span>&#123;</div><div class="line">    &lt;T&gt; <span class="function">T <span class="title">when</span><span class="params">(T mock)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doThrow</span><span class="params">(Throwable... toBeThrown)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doThrow</span><span class="params">(Class&lt;? extends Throwable&gt; toBeThrown)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doThrow</span><span class="params">(Class&lt;? extends Throwable&gt; toBeThrown, Class&lt;? extends Throwable&gt;... nextToBeThrown)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doAnswer</span><span class="params">(Answer answer)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doNothing</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doReturn</span><span class="params">(Object toBeReturned)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doReturn</span><span class="params">(Object toBeReturned, Object... nextToBeReturned)</span></span>;</div><div class="line">    <span class="function">Stubber <span class="title">doCallRealMethod</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看出，<code>doXXX</code> 方法的返回值是一个 <code>Stubber</code>，<code>when</code> 方法对 mock 对象进行处理之后再返回这个对象。</p>
<h2 id="OngoingStubbing"><a href="#OngoingStubbing" class="headerlink" title="OngoingStubbing"></a>OngoingStubbing</h2><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OngoingStubbing</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenReturn</span><span class="params">(T value)</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenReturn</span><span class="params">(T value, T... values)</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenThrow</span><span class="params">(Throwable... throwables)</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenThrow</span><span class="params">(Class&lt;? extends Throwable&gt; throwableType)</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenThrow</span><span class="params">(Class&lt;? extends Throwable&gt; toBeThrown, Class&lt;? extends Throwable&gt;... nextToBeThrown)</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenCallRealMethod</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">thenAnswer</span><span class="params">(Answer&lt;?&gt; answer)</span></span>;</div><div class="line">    <span class="function">OngoingStubbing&lt;T&gt; <span class="title">then</span><span class="params">(Answer&lt;?&gt; answer)</span></span>;</div><div class="line">    &lt;M&gt; <span class="function">M <span class="title">getMock</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用 <code>Mockito#when</code> 返回一个 <code>OngoingStubbing</code>，通过 <code>OngoingStubbing#thenXxx</code> 可以改变 mock 对象的行为，从而产生一个 stubbing。</p>
<p><em>示例代码</em><br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line">when(mock.someMethod(anyString())).thenReturn(<span class="number">10</span>);</div></pre></td></tr></table></figure></p>
<h2 id="Answer"><a href="#Answer" class="headerlink" title="Answer"></a>Answer</h2><p>不管是 <code>Stubber</code> 还是 <code>OngoingStubbing</code>，除了标准返回之外，都提供了自定义返回值的方法：</p>
<ul>
<li><code>Stubber doAnswer(Answer answer);</code></li>
<li><code>OngoingStubbing&lt;T&gt; then(Answer&lt;?&gt; answer);</code></li>
</ul>
<p>Answer 的接口定义如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Answer</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">    <span class="function">T <span class="title">answer</span><span class="params">(InvocationOnMock invocation)</span> <span class="keyword">throws</span> Throwable</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如下代码利用 <code>Answer</code> 改变了 mock 方法的行为：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">when(mock.someMethod(anyString())).thenAnswer(</div><div class="line">    <span class="keyword">new</span> Answer() &#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">answer</span><span class="params">(InvocationOnMock invocation)</span> </span>&#123;</div><div class="line">            Object[] args = invocation.getArguments();</div><div class="line">            Object mock = invocation.getMock();</div><div class="line">            <span class="keyword">return</span> <span class="string">"called with arguments: "</span> + Arrays.toString(args);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>那么 <code>mock.someMethod(&quot;foo&quot;)</code> 的返回值就变成了 <code>called with arguments: [foo]</code>。</p>
<p><code>Answer</code> 不接受参数，只有返回值，Mockito 还提供了其他 5 个 Answer，分别接受不同个数的参数，然后返回一个值。</p>
<ul>
<li>Answer1</li>
<li>Answer2</li>
<li>Answer3</li>
<li>Answer4</li>
<li>Answer5</li>
</ul>
<p>只接受参数，没有返回值的 Answer 包括：</p>
<ul>
<li>VoidAnswer1</li>
<li>VoidAnswer2</li>
<li>VoidAnswer3</li>
<li>VoidAnswer4</li>
<li>VoidAnswer5</li>
</ul>
<blockquote>
<p><code>ValidableAnswer</code> 用到再分析</p>
</blockquote>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/UnitTest/">UnitTest</a>, <a href="/tags/Mockito/">Mockito</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>
  <div id="uyan_frame"></div>
  <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128686"></script>
</section>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:liangfei.me">
  </form>
</div>

  

  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/CSS/" style="font-size: 13.33px;">CSS</a> <a href="/tags/Car/" style="font-size: 10px;">Car</a> <a href="/tags/Dart/" style="font-size: 11.67px;">Dart</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/Git/" style="font-size: 11.67px;">Git</a> <a href="/tags/Google/" style="font-size: 10px;">Google</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/HTTP2/" style="font-size: 10px;">HTTP2</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="/tags/Mockito/" style="font-size: 15px;">Mockito</a> <a href="/tags/Retrofit/" style="font-size: 11.67px;">Retrofit</a> <a href="/tags/RxJava/" style="font-size: 10px;">RxJava</a> <a href="/tags/Security/" style="font-size: 10px;">Security</a> <a href="/tags/Summary/" style="font-size: 18.33px;">Summary</a> <a href="/tags/UnitTest/" style="font-size: 16.67px;">UnitTest</a> <a href="/tags/Web/" style="font-size: 11.67px;">Web</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a> <a href="/tags/产品设计/" style="font-size: 10px;">产品设计</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a>
  </div>
</div>


  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2017/08/24/css-position/">精通CSS之position</a>
      </li>
    
      <li>
        <a href="/2017/08/22/meeting-css/">Beautiful CSS</a>
      </li>
    
      <li>
        <a href="/2017/08/21/meeting-weapp/">小程序开发总结</a>
      </li>
    
      <li>
        <a href="/2017/08/21/note-on-css-mastery/">CSS Mastery笔记</a>
      </li>
    
      <li>
        <a href="/2017/07/26/mockito-details-5-annotation/">Mockito 详解（五）MockitoAnnotation</a>
      </li>
    
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 liangfei
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>